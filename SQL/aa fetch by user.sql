/* Needs to be run on stats db to catch historical data. This means course_contents is not available

   Might be better to use the ods_aa_content_activity table?
   */
select u.student_id as id,
       aa.timestamp, cm.course_id as subject_code, cm.course_name as subject,
       u.firstname, u.lastname, cu.role,
       cu.row_status,
       aa.session_id as session_id,
       aa.event_type as event,
       aa.internal_handle as handle,
       aa.data as data,
       aa.content_pk1
       --,cc.cnthndlr_handle, cc.content_type, cc.web_url
from activity_accumulator aa
  left join course_main cm on aa.course_pk1 = cm.pk1
  left join course_users cu on cu.crsmain_pk1 = aa.course_pk1 and cu.users_pk1 = aa.user_pk1
  left join users u on cu.users_pk1 = u.pk1
  --left join course_contents cc on cm.pk1 = cc.crsmain_pk1
  where
        (cm.course_id like '%_2016%' or
         cm.course_id like '%_2017%' or
         cm.course_id like '%_2018%' or
         cm.course_id like '%_2019%')
    and
        u.student_id in (
            '11679333',
'11646694',
'11528160',
'11588871',
'11547811',
'11685118',
'11574835',
'11685930',
'11702106',
'11696874',
'11639247',
'11682394',
'11497867',
'11642601B',
'95035993',
'11576561',
'11598346',
'11621237',
'11677120',
'11683728',
'11684983',
'11688352',
'11689253',
'95049941',
'11588871',
'11685887',
'11671761',
'11683130',
'11685930',
'11665431',
'11685287',
'11426684',
'11684324',
'11678084',
'11622143',
'11492048',
'11143824',
'11479697',
'11703139',
'11436386',
'11629542',
'11694744',
'11691710',
'11263826',
'11702582',
'11671443',
'11664217',
'11655997',
'11700938',
'11678436',
'11693632',
'11570026',
'11674869',
'11689086',
'11681495',
'11471622',
'11680029',
'11688297',
'11678976',
'11697498',
'11683490',
'11655686',
'11577581',
'11687471',
'11656283',
'11643411',
'11691352',
'11680270',
'11664902',
'11371911',
'11700728',
'11594261',
'11624231',
'11631412',
'11648859',
'11658895',
'11675864',
'11689743',
'11508588',
'11522472',
'11533787',
'11286688',
'11698259',
'11702134',
'11702640',
'11702782',
'11699022',
'11658955',
'95041693',
'95031490',
'11643465',
'11684472',
'11685519',
'11703505',
'11703555',
'95051428',
'11703511',
'11694928',
'11653712',
'11692859',
'11638666',
'11513167',
'11695003',
'11654845',
'11696954',
'11699876',
'11524718',
'11643537',
'11621533',
'11700585',
'11701558',
'11663404',
'11692866',
'11600778',
'11611869',
'11638470',
'11652104',
'11657592',
'11659602',
'11664806',
'11526005',
'11660744',
'11663404',
'11689960',
'11690280',
'11519346',
'11526434',
'11595349',
'11608214',
'11620448',
'11628554',
'11373613',
'11677109',
'11677671',
'11682754',
'11687537',
'11687609',
'11689077',
'11689789',
'11692128',
'11693428',
'11225905',
'11535372',
'11546069',
'11483559',
'11524718',
'11658102',
'11696954',
'11593492',
'11655259',
'11695460',
'11700769',
'11700673',
'11698175',
'11698115',
'11700605',
'11700774',
'11701250',
'11444497',
'11638907',
'11699463',
'11702377',
'11698316',
'11699724',
'11701656',
'11700076',
'11683564',
'11698613',
'11693930',
'11656659',
'11689695',
'11698812',
'11698222',
'11701179',
'11701146',
'11688716B',
'11669725B',
'11624177',
'11627898',
'11515074',
'11660076',
'11225063',
'11701377',
'11686204',
'11646341',
'11647477',
'11686304',
'11596970',
'11644742',
'11685287',
'11548907',
'11651111',
'11699876',
'11700585',
'11589772',
'11636073',
'11681756',
'11282026',
'11660204',
'11601574',
'11692453',
'11652930',
'11668700',
'11631634',
'11702031',
'11663402',
'11678983',
'11681908',
'11683496',
'11684570',
'11684900',
'11621516',
'11642783',
'11683157',
'11681221',
'11630905',
'11622477',
'11656220',
'11627676',
'11687223',
'11687243',
'11688193',
'11693379',
'11697962',
'11419561',
'11450862',
'11430981',
'11258383',
'11699709',
'11631510',
'11668298',
'11680426',
'11694126',
'11692514',
'11524492',
'11679545',
'11683129',
'11684686',
'11681239',
'11681364',
'11688956',
'11537958',
'11572831',
'11574790',
'11578067',
'11623067',
'11658497',
'11666675',
'11501129',
'11518478',
'11542247',
'11599429',
'11683304',
'11694913',
'11628928',
'11600661',
'11542305',
'11701799',
'11444365',
'11206541',
'11644019',
'11640605',
'11220906',
'11625035',
'11642248',
'11335068',
'11588115B',
'11655308',
'11603792',
'11593018',
'11694641',
'11156949',
'11168953',
'11472778',
'11506847',
'11637362B',
'11606371',
'11676075',
'11688329',
'11658244',
'11453450',
'11346768',
'11641691',
'11591785',
'11632711',
'11666042',
'11626990',
'11673574',
'11690660',
'11650161',
'11681096',
'11686145',
'11702647',
'11625396',
'11628401',
'11548233',
'11702246',
'11498152',
'11700872',
'11617439',
'11546536',
'11577123',
'11620481',
'11687539',
'11694598',
'11656935',
'11477610',
'11675377',
'11692774',
'11623178',
'11583082',
'11660186',
'11648418',
'11679461',
'11648494',
'11517651',
'11489968',
'11679489',
'11246134',
'11700446',
'11628183',
'11666655',
'11701727',
'11677028',
'11619769',
'11494420',
'11176702',
'11692673',
'11658163',
'11634586',
'11689957',
'11558603',
'11388194',
'11618730',
'11540239',
'11548266',
'11626009',
'11672748',
'11700603',
'11681891',
'11660515',
'11649578',
'11687277',
'11602438',
'11693736',
'11693390',
'11691081',
'11678259',
'11614872',
'11694408',
'11658031',
'11464287',
'11658960',
'11692556',
'11679144',
'11578974',
'11580528',
'11684579',
'11695554',
'11683863',
'11547531',
'11688487',
'11701940',
'11683179',
'11692578',
'11669898',
'11572450',
'11686082',
'11355530',
'11679236',
'11691741',
'11535802',
'11694534',
'11438246',
'11624084',
'11577596',
'11668181',
'11684659',
'11686429',
'11655257',
'11574893',
'11686476',
'11603814',
'11572909',
'11674823',
'11672779',
'11694617',
'11628135',
'11586905',
'11625515',
'11646902',
'11668207',
'11687014',
'11691128',
'11695049',
'11441587',
'11467732',
'11508280',
'11538925',
'11556572',
'11703184',
'11674620',
'11687390',
'11644163',
'11700126',
'11698593',
'11682664',
'11700131',
'11667945',
'11626438',
'11596357',
'11693074',
'11703598',
'11701249',
'11530621',
'11669271',
'11596328',
'11674242',
'11672624',
'11698011',
'11703463',
'11701048',
'11700576',
'11671289',
'11624593',
'11263016',
'11701555',
'11694647',
'11672247',
'11671743',
'11641421',
'11694374',
'11697093',
'11703715',
'11473058',
'11374682',
'11687014',
'11441587',
'11697471',
'11479027',
'11585751',
'11572520',
'11695049',
'11703184',
'11665635',
'11646902',
'11229052',
'11602888',
'11323127A',
'11697721',
'94011458',
'11701653',
'11689550',
'11694494',
'11696934',
'11630923',
'11586923',
'11617977',
'11242257',
'11602285A',
'11653064',
'11668207',
'11679281',
'11663841',
'11685543',
'11659778',
'11670028',
'11600697',
'11617866',
'11495177',
'11681866',
'11687880',
'11664550',
'11691253',
'11663218',
'11507031',
'11642686',
'11571473',
'11521462',
'11679862',
'99978800',
'11617677',
'11495351',
'11667349',
'11625617',
'11644547',
'11416119',
'11569069',
'11583444',
'11615353',
'11669312',
'11670626',
'11627224',
'11700169',
'11656613',
'11683996',
'11658265',
'11682435',
'11676464',
'11499103',
'11690326',
'11688507',
'11444000',
'11599142',
'11551949',
'11655182',
'11685906',
'11681438',
'11690344',
'11662818',
'11682336',
'11681848',
'11684804',
'94088671',
'11683184',
'11680488',
'11626240',
'11684900',
'11383286B',
'11668865',
'11584456',
'11611374',
'11491709',
'11670612',
'11658312',
'11681553',
'11658615',
'11594369',
'11654519',
'11689506',
'11654568',
'11677004',
'11682719',
'11686008',
'11599553',
'11659210',
'11545008',
'11610454',
'11672339',
'11671679',
'11551522',
'11623042',
'11668177',
'11701911',
'11560695',
'11693931',
'11653352',
'11654972',
'11567048',
'11603407',
'11659340',
'11598476',
'11630935',
'11674699',
'11700572',
'11686112',
'11694234',
'11611366B',
'11672689',
'11628578',
'11683329',
'11677028',
'11491709',
'11699018',
'11582215',
'11600032',
'11257595',
'11659731',
'11693980',
'11623560',
'11675377',
'11698478',
'11681699',
'11665412',
'11685535',
'11243005',
'11682188',
'11651584',
'11611374',
'11668296',
'94041141',
'11699099',
'11420205',
'11699587',
'11676338',
'11668025',
'11699024',
'11602394B',
'11614553',
'60937352',
'11473336',
'11694215',
'11685241',
'11697700',
'11450818',
'11592723',
'11274132',
'11683148',
'11700941',
'11167415',
'11688950',
'11685890',
'11677844',
'11669626A',
'11673571',
'11647476',
'11631953',
'11477550',
'11648484',
'11688327',
'11686085',
'11685212',
'11693400',
'11417931',
'11230419',
'11698673',
'11640104',
'11700458',
'11291761',
'11696914',
'11686019',
'11702127',
'11702564',
'11701954',
'11695125',
'11670458',
'11587054',
'11698318',
'11697041',
'11694234',
'11683391',
'11694863',
'11608616',
'11657253',
'11659080',
'11702580',
'11567048',
'11672689',
'11590377',
'11703659',
'11494457',
'11569336',
'11701248',
'11618030',
'11631531',
'11598853',
'11674759',
'11692428',
'11693699',
'11670282',
'11670371',
'11700783',
'11701028',
'11701572',
'11232803',
'11601345',
'11651088',
'11675454',
'11289419',
'11680560',
'11658279',
'11629324',
'11681171',
'11687152',
'11677842',
'11692759',
'11648478',
'11670399',
'11686325',
'11682872',
'11648779',
'11671185',
'11694366',
'11341530',
'86110739',
'11686685',
'11699328',
'11523171',
'11611823',
'11570969',
'11682407',
'11504946',
'11599156',
'11585922',
'11646223',
'11421069A',
'11658770',
'11397105',
'11655199',
'11656428',
'11677819',
'11657408',
'94079834',
'11687917',
'11691139',
'11576763B',
'11688745',
'11702482',
'11210704',
'11651320',
'11698648',
'11698945',
'11620166',
'11676275',
'11650788',
'11695070',
'11515035A',
'11544609',
'11278318',
'11702844',
'11656650',
'11672493',
'11675063',
'11676611',
'11691175',
'11694581',
'11686337',
'11639659',
'11628829',
'94076003',
'11598973',
'11624463',
'11665983',
'11551121',
'11700886',
'11698334',
'11656005',
'11676392',
'11679874',
'11684715',
'11700775',
'11602613',
'11431910',
'11576901',
'11655647',
'11549945',
'95033656',
'11650540',
'11653097',
'11631297',
'11699367',
'11702656',
'11665515',
'11685300',
'11699294',
'11598595',
'11680073',
'11679686',
'11684498',
'11625183',
'11657975',
'11677547',
'11675757',
'11672051',
'11622902',
'11588857',
'11442178',
'11629016',
'11693494',
'11500590',
'11680226',
'11658501',
'11682339',
'11620203',
'11660801',
'11686127',
'11673554',
'11597347',
'11688402',
'11655072',
'11659018',
'11686591',
'11579239',
'11691955',
'11477355',
'11658741',
'11683101',
'11631588',
'11655351',
'11658674',
'11676090',
'11682432',
'11685889',
'11570502',
'11654626',
'11660890',
'11630087',
'11655359',
'11654988',
'11488713',
'11572529',
'11546035',
'11480038',
'11679181',
'11684131',
'11694115',
'11405782',
'11591797',
'11693135',
'11631274',
'11658283',
'11676611',
'11686023',
'11599266',
'11654951',
'11652514',
'11655452',
'11684825',
'11516735',
'11633173',
'11662790',
'11688005',
'11694982',
'11523795',
'11544288',
'11311995A',
'11679650',
'11679226',
'11482635',
'11495111',
'11499851',
'11595793',
'11646858',
'11685068',
'11692954',
'92139047',
'11692110',
'11700595',
'11477610',
'11628931',
'11688487',
'11672304',
'11689817',
'11691812',
'11680971',
'11652979',
'11560542',
'11657073',
'11685573',
'11694467',
'11676385',
'11679738',
'11684412',
'11658760',
'11682408',
'11656613',
'11650861',
'11612113',
'11627149',
'11672331',
'11683921',
'11698684',
'11399790',
'11560629',
'11616794',
'11539708',
'11582952',
'11702760',
'11703578',
'11307201',
'11702104',
'11668859',
'11695501',
'11682092'
        )
    /* Pre HECS filter
    and aa.timestamp < make_date(2018, 3, 1)
    and aa.timestamp > make_date(2018, 2, 1)
       */
/*  and u.user_id is not null
  and cu.role like 'S'-- and cu.row_status = 0 -- getting only enrolled students

 */